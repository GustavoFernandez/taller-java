<!doctype html>
<html lang="es">
	<head>
		<meta charset="utf-8">
		<title>JDBC</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/beige.css" id="theme">
		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">
		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<div class="slides">
				<section>
					<h1>JDBC</h1>
					<p>Conexión a base de datos con Java</p>
					<br>
					<p>
						<small>By <a href="https://twitter.com/gustavofersan" target="_blank">Gustavo Fernández</a> / <a href="https://twitter.com/gustavofersan" target="_blank">@gustavofersan</a></small>
					</p>
				</section>

				<section>
					<section>
						JDBC es un API con el cual se puede acceder a datos tabulares, especialmente almacenados en Bases de datos relacionales.
					</section>
					<section>
						<ol>
							<li>Conectar a una fuente de datos, p.e. una base de datos</li>
							<li>Enviar sentencias de consulta y manipulación de datos a la base de datos</li>
							<li>Obtener y procesar los resultados recibidos de la base de datos en respuesta a una consulta.</li>
						</ol>
					</section>
				</section>

				<section>
					<section>
						<img src="img/jdbc/class-diagram.jpg">
					</section>
					<section>
						<h2>Elementos principales</h2>
						<p>Todo driver JDBC debe implementar algunas clases para conectarse a una base de datos, ejecutar consultas y manipular datos</p>
					</section>
					<section>
						<h2 style="text-transform:none">java.sql.Connection</h2>
						<p>Una conexión que representa la sesión entre la aplicación Java y la base de datos</p>
						<pre><code class="java">Connection con = DriverManager.getConnection(url, username, password);</code></pre>
					</section>
					<section>
						<h2 style="text-transform:none">java.sql.Statement</h2>
						<p>Objeto usado para ejecutar sentencias SQL estáticas y retornar el resultado</p>
						<pre><code class="java">Statement stmt = con.createStatement();</code></pre>
					</section>
					<section>
						<h2 style="text-transform:none">java.sql.ResultSet</h2>
						<p>Un objeto que representa un conjunto de resultados devuelto por la base de datos.</p>
						<pre><code class="java">String query = "SELECT * FROM Employee";
ResultSet rs = stmt.executeQuery(query);
</code></pre>
					</section>
					<section>
						<pre><code class="java">public void connectToAndQueryDatabase(String username, String password) {

    Connection con = DriverManager.getConnection(
    					"jdbc:myDriver:myDatabase",
    					username,
    					password);
    Statement stmt = con.createStatement();
    ResultSet rs = stmt.executeQuery("SELECT a, b, c FROM Table1");

    while (rs.next()) {
        int x = rs.getInt("a");
        String s = rs.getString("b");
        float f = rs.getFloat("c");
    }

    con.close();
}</code></pre>
					</section>
					<section>
						<table style="font-size:.7em">
							<tr>
								<th>RDBMS</th>
								<th>JDBC driver name</th>
								<th>URL format</th>
							</tr>
							<tr>
								<td>MySQL</td>
								<td>com.mysql.jdbc.Driver</td>
								<td><b>jdbc:mysql://</b>hostname/ databaseName</td>
							</tr>
							<tr>
								<td>ORACLE</td>
								<td>oracle.jdbc.driver.OracleDriver</td>
								<td><b>jdbc:oracle:thin:@</b>hostname:port Number:databaseName</td>
							</tr>
							<tr>
								<td>DB2</td>
								<td>COM.ibm.db2.jdbc.net.DB2Driver</td>
								<td><b>jdbc:db2:</b>hostname:port Number/databaseName</td>
							</tr>
							<tr>
								<td>Sybase</td>
								<td>com.sybase.jdbc.SybDriver</td>
								<td><b>jdbc:sybase:Tds:</b>hostname: port Number/databaseName</td>
							</tr>
						</table>
					</section>
				</section>

				<section>
					<h2>Arquitectura JDBC</h2>
					<img src="img/jdbc/jdbc-architecture.gif" width="50%">
				</section>

				<section>
					<section>
						<h2 style="text-transform:none">Usando un objeto ResultSet</h2>
						<img src="img/jdbc/result-set.jpg">
					</section>
				</section>

				<section>
					<section>
						<h2>Escribiendo Consultas y obteniendo resultados</h2>
						<p>
							Para ejecutar consultas SQL se debe crear un objeto que envuelva esa consulta, una instancia de Statement
						</p>
						<pre><code class="java">Statement stmt = con.createStatement();</code></pre>
					</section>
					<section>
						<p>Usamos la instancia de Statement para ejecutar la consulta.</p>
						<pre><code class="java">ResultSet rs = stmt.executeQuery (query);</code></pre>
					</section>
					<section>
						<p>Statement tiene 3 métodos para ejecutar las consultas SQL</p>
						<table style="font-size:.7em">
							<tr>
								<th>Método</th>
								<th>Retorno</th>
								<th>Usado para</th>
							</tr>
							<tr>
								<td>executeQuery(sqlString)</td>
								<td>ResultSet</td>
								<td>Sentencias SELECT</td>
							</tr>
							<tr>
								<td>executeUpdate(sqlString)</td>
								<td>int (filas afectadas)</td>
								<td>INSERT, UPDATE, DELETE, o cualquier DDL</td>
							</tr>
							<tr>
								<td>execute(sqlString)</td>
								<td>boolean (true si devuelve un ResultSet)</td>
								<td>Cualquier sentencia SQL</td>
							</tr>
						</table>
					</section>
				</section>

				<section>
					<h2>Transacciones</h2>
				</section>

				<section>
					<section>
						<h2>Preguntas</h2>
						<img src="img/thinking.png" height="192" width="186" alt="">
					</section>
					<section>
						¿Qué método de Statement ejecuta una sentencia SQL y retorna el número de filas afectadas?
						<pre><code class="java">1. stmt.executeQuery(query);

2. stmt.executeUpdate(query);

3. stmt.executeQuery(query);

4. stmt.query(query);</code></pre>
					</section>
					<section>
						Cuando usas un <em>Statement</em> para ejecutar una consulta que devuelve solo un registro ¿Es necesario usar el método <em>next()</em> del <em>ResultSet</em> para consultar este único registro?
					</section>
				</section>

				<section style="text-align: left;">
					<h1>THE END</h1>
					<p>
						- <a href="http://slides.com">Try the online editor</a> <br>
						- <a href="https://github.com/hakimel/reveal.js">Source code &amp; documentation</a>
					</p>
				</section>

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
